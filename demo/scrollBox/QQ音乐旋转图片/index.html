<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QQ音乐旋转图片</title>
    <link rel="stylesheet" href="../../../css/base.css">
    <link rel="stylesheet" href="main.css">
</head>
<body>
<div id="main">
    <div class="scrollBox">
        <div class="title">
            <h2 class="great">精彩推荐</h2>
        </div>
        <div class="slideBox">
            <ul>
                <li class="item pic-c" data-index="0">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71035.jpg" class="event_list__pic" alt="YQQ-李玟直播预约">
                    </a>
                </li>
                <li class="item pic-r" data-index="1">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71069.jpg" class="event_list__pic" alt="YQQ-防弹少年团正售">
                    </a>
                </li>
                <li class="item pic-r-no" data-index="2">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71368.jpg" class="event_list__pic" alt="hebe 井柏然">
                    </a>
                </li>
                <li class="item pic-r-no" data-index="3">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71382.jpg" class="event_list__pic" alt="思美人">
                    </a>
                </li>
                <li class="item pic-r-no" data-index="4">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71387.jpg" class="event_list__pic" alt="容祖儿">
                    </a>
                </li>
                <li class="item pic-r-no" data-index="5">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71025.jpg" class="event_list__pic" alt="YQQ-歌手-第四期">
                    </a>
                </li>
                <li class="item pic-l-no" data-index="6">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/71065.jpg" class="event_list__pic" alt="PC 新歌八达通">
                    </a>
                </li>
                <li class="item pic-l-no" data-index="7">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/70751.jpg" class="event_list__pic" alt="音缺pc">
                    </a>
                </li>
                <li class="item pic-l-no" data-index="8">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/mv_t_mv_focus/70933.jpg" class="event_list__pic" alt="高甜预警！情人节虐狗日记">
                    </a>
                </li>
                <li class="item pic-l" data-index="9">
                    <a href="#">
                        <img src="https://y.gtimg.cn/music/common/upload/t_focus_info_iphone/70425.jpg" class="event_list__pic" alt="PC新年好幸运">
                    </a>
                </li>
            </ul>
        </div>
        <div class="tab">
            <a href="#" class="active"><i>1</i></a>
            <a href="#"><i>2</i></a>
            <a href="#"><i>3</i></a>
            <a href="#"><i>4</i></a>
            <a href="#"><i>5</i></a>
            <a href="#"><i>6</i></a>
            <a href="#"><i>7</i></a>
            <a href="#"><i>8</i></a>
            <a href="#"><i>9</i></a>
            <a href="#"><i>10</i></a>
        </div>
    </div>
    <div id="control">
        <div class="action goleft">
            <a href="#" class="prev">&lt;</a>
        </div>
        <div class="action goright">
            <a href="#" class="next">&gt;</a>
        </div>
    </div>
</div>
<script>
    (function(){
        var wrap =document.getElementById("main");
        var box =wrap.getElementsByClassName("scrollBox")[0];
        var oU =box.getElementsByTagName("ul")[0];
        var list =oU.getElementsByTagName("li");
        var len =list.length;
        var tab =box.getElementsByClassName("tab")[0];
        var point =tab.getElementsByTagName("a");
        var prev =wrap.getElementsByClassName("prev")[0];
        var next =wrap.getElementsByClassName("next")[0];
        var pos=[];
        var count =0;
        for(var i=0;i<len;i++){
            var item =list[i];
            pos.push({
                top:parseInt(getStyle(item,"top")),
                left:parseInt(getStyle(item,"left")),
                width:parseInt(getStyle(item,"width")),
                height:parseInt(getStyle(item,"height")),
                zIndex:parseInt(getStyle(item,"zIndex")),
                opacity:parseInt(getStyle(item,"opacity"))
            });
        }
        function autoPlay() {
            count++;
            count>=len&&(count=0);
            scroll(count);
        }
        timer =setInterval(autoPlay,3000);
        function scroll(cur) {
            show(cur);
            var re =center(cur,pos.slice(0));
            for(var i=0;i<len;i++){
                list[i].style.zIndex =re[i].zIndex;
                list[i].style.opacity =re[i].opacity;
                move(list[i],re[i]);
            }
        }
        function show(cur) {
            for(var i=0;i<len;i++){
                point[i].className ="";
            }
            point[cur].className="active";
        }
        function center(cur,pos) {
            cur =pos.length-cur;
            for(var i=0;i<Math.abs(cur);i++){
                cur>0?pos.push(pos.shift()):pos.unshift(pos.pop());
            }
            return pos;
        }
        wrap.onmouseover=function(){
            clearInterval(timer);
            timer =null;
        };
        wrap.onmouseout =function(){
          timer =setInterval(autoPlay,3000);
        };
        next.onclick = function(){
            count +=1;
            count = count%len;
            scroll(count);
        };
        prev.onclick=function () {
            if(count>0){
                count--;
            }else{
                count=9;
            }
            scroll(count);
        };
        function getStyle(obj, attr){
            if(obj.currentStyle){
                return obj.currentStyle[attr];
            } else {
                return getComputedStyle(obj, false)[attr];
            }
        }
        function move(obj, json, fn){
            clearInterval(obj.timer);
            obj.timer = setInterval(function(){
                var stop = true;
                for(var attr in json){
                    var target = json[attr];
                    var cur = parseInt(getStyle(obj, attr));
                    var speed = (target - cur) / 8;
                    speed = speed > 0 ? Math.ceil(speed) : Math.floor(speed);
                    if(target != cur){
                        stop = false;
                    }
                    cur += speed;
                    obj.style[attr] = cur + 'px';
                }
                if(stop){
                    clearInterval(obj.timer);
                    obj.timer = null;
                    fn && fn();
                }
            }, 30);
            for(var j=0;j<len;j++){
                point[j].index =j;
                point[j].onclick =function () {
                    scroll(this.index);
                }
            }
        }
    })();
</script>
</body>
</html>